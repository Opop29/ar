<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR Navigation HUD</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-gps-camera@1.7.0/dist/aframe-gps-camera.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-gps-entity-place@1.7.0/dist/aframe-gps-entity-place.min.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    /* HUD Overlays */
    .hud {
      position: absolute;
      z-index: 9999;
      color: white;
    }
    #etaBox {
      top: 15px;
      left: 15px;
      background: rgba(0,0,0,0.6);
      padding: 10px;
      border-radius: 8px;
    }
    #directionBox {
      top: 15px;
      right: 15px;
      background: rgba(0,0,0,0.6);
      padding: 10px;
      border-radius: 8px;
      text-align: right;
    }
    #compass {
      bottom: 15px;
      right: 15px;
      background: rgba(0,0,0,0.6);
      width: 100px;
      height: 100px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #time {
      bottom: 15px;
      left: 15px;
      background: rgba(0,0,0,0.6);
      padding: 8px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <!-- HUD Panels -->
  <div id="etaBox" class="hud">
    <div>ETA: <span id="eta">--</span></div>
    <div><span id="duration">--</span></div>
  </div>

  <div id="directionBox" class="hud">
    <div><span id="distance">--</span> ft</div>
    <div>Turn <span id="turn">--</span> on <b id="street">--</b></div>
  </div>

  <div id="compass" class="hud">
    ðŸ§­
  </div>

  <div id="time" class="hud">
    <span id="clock">--:--</span>
  </div>

  <!-- A-Frame Scene -->
  <a-scene
    vr-mode-ui="enabled: false"
    embedded
    arjs="sourceType: webcam; facingMode: environment; debugUIEnabled: false;"
  >
    <!-- GPS Camera -->
    <a-camera gps-camera rotation-reader></a-camera>
  </a-scene>

  <script>
    // Example saved locations (from Supabase or localStorage)
    const route = [
      { lat: 37.7749, lon: -122.4194, name: "Market St", turn: "right", distance: 50 },
      { lat: 37.7755, lon: -122.4180, name: "Smithe St", turn: "left", distance: 120 }
    ];

    const scene = document.querySelector("a-scene");

    // Place arrows on route
    route.forEach(loc => {
      const arrow = document.createElement("a-entity");
      arrow.setAttribute("gps-entity-place", `latitude: ${loc.lat}; longitude: ${loc.lon}`);
      arrow.setAttribute("gltf-model", "https://cdn.aframe.io/test-models/models/arrow/arrow.gltf");
      arrow.setAttribute("scale", "5 5 5");
      arrow.setAttribute("look-at", "[gps-camera]");
      scene.appendChild(arrow);
    });

    // Update HUD clock
    setInterval(() => {
      const now = new Date();
      document.getElementById("clock").textContent =
        now.getHours() + ":" + String(now.getMinutes()).padStart(2, '0');
    }, 1000);

    // Mock ETA + direction
    document.getElementById("eta").textContent = "3:05 PM";
    document.getElementById("duration").textContent = "14 min";
    document.getElementById("distance").textContent = "50";
    document.getElementById("turn").textContent = "right";
    document.getElementById("street").textContent = "Smithe St";
  </script>
</body>
</html>
